# apply-mimeogram

## Purpose
Enables users to apply changes contained in a mimeogram to the local filesystem. This capability is essential for incorporating code or text generated by LLMs back into the project.

## Requirements

### Requirement: Input Source
The system SHALL accept mimeogram input from a file, standard input, or the system clipboard.

Priority: Critical

#### Scenario: File input
- **WHEN** user provides a file path as input
- **THEN** the mimeogram is read from that file

#### Scenario: Stdin input
- **WHEN** user pipes content to the command
- **THEN** the mimeogram is read from standard input

#### Scenario: Clipboard input
- **WHEN** user provides the `--from-clipboard` flag
- **THEN** the mimeogram is read from the system clipboard

### Requirement: Interactive Review
The system SHALL support an interactive review mode where users can approve, reject, or modify changes before they are applied.

Priority: High

#### Scenario: Partitive review (default on TTY)
- **WHEN** running in an interactive terminal
- **AND** review mode is not explicitly set to silent
- **THEN** the user is prompted for action on each part (Apply, Diff, Edit, Ignore, etc.)

### Requirement: Silent Application
The system SHALL support a silent mode to apply all changes without user interaction.

Priority: Medium

#### Scenario: Silent mode
- **WHEN** user provides the `--review-mode silent` flag (or runs non-interactively)
- **THEN** all parts are applied without prompting

### Requirement: Base Directory
The system SHALL allow users to specify a base directory for relative paths in the mimeogram.

Priority: Medium

#### Scenario: Base directory specified
- **WHEN** user provides `--base-directory /path/to/dir`
- **THEN** file paths in the mimeogram are resolved relative to that directory

### Requirement: Filesystem Protection
The system SHALL identify and protect sensitive files from being overwritten, requiring explicit user permission or a force flag.

Priority: Critical

#### Scenario: Protected file modification
- **WHEN** a mimeogram contains changes to a protected file (e.g., in `.config`)
- **THEN** the system flags the file as protected
- **AND** requires explicit confirmation or the `--disable-protections` flag to apply changes

### Requirement: Update Execution
The system SHALL apply the accepted changes to the filesystem.

Priority: Critical

#### Scenario: Apply changes
- **WHEN** a part is marked for application (via interactive choice or silent mode)
- **THEN** the file at the target path is updated with the content from the mimeogram
